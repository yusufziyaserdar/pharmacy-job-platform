@model IEnumerable<PharmacyJobPlatform.Web.Models.ViewModels.InboxConversationViewModel>

@if (!Model.Any())
{
    <div class="messages-empty">
        <i class="bi bi-chat-left"></i>
        <p>Henüz bir mesajlaşmanız yok.</p>
    </div>
}
else
{
    @foreach (var conv in Model)
    {
        <div class="messages-conversation"
             data-id="@conv.ConversationId"
             data-name="@conv.OtherUserFullName"
             data-profile="/Profile/@conv.OtherUserId"
             onclick="openInboxConversation(@conv.ConversationId)">
            <div class="messages-avatar">
                @(string.IsNullOrWhiteSpace(conv.OtherUserFullName) ? "?" : conv.OtherUserFullName.Substring(0, 1))
            </div>
            <div class="messages-conversation-body">
                <div class="messages-conversation-title">@conv.OtherUserFullName</div>
                <div class="messages-conversation-preview">@conv.LastMessage</div>
            </div>
            <div class="messages-conversation-actions">
                @if (conv.UnreadCount > 0)
                {
                    <span class="badge bg-danger rounded-pill">@conv.UnreadCount</span>
                }
                <details class="messages-menu" onclick="event.stopPropagation();">
                    <summary class="messages-menu-toggle" onclick="event.stopPropagation();" aria-label="Konuşma seçenekleri">
                        <i class="bi bi-three-dots"></i>
                    </summary>
                    <div class="messages-menu-body">
                        <button class="messages-menu-item"
                                type="button"
                                onclick="event.stopPropagation(); deleteConversation(@conv.ConversationId)">
                            Sil
                        </button>
                        <button class="messages-menu-item"
                                type="button"
                                onclick="event.stopPropagation(); endConversation(@conv.ConversationId)">
                            Sohbeti bitir
                        </button>
                    </div>
                </details>
            </div>
        </div>
    }
}
